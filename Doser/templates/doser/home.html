{% extends 'doser/base.html' %}

{% block content %}

<!-- Dose Run -->
{% if doseList %}
<div class="bdivider">
	<div class="content">
		<form action="/doser/" method="post" id="queueDose">
			{% csrf_token %}
			<div class="text-center font-bold">
				Choose amount for manual dose
			</div>
			<div class="content-withtitle">
				{% for step in stepSizeList %}
				{% if step == lastStepSize %}
				<input class="btn-radio" type="radio" name="stepSize" title="Select step size for operations below" checked="checked" value="{{step}}"><label>{{step}} ml</label></td>
				{% else %}
				<input class="btn-radio" type="radio" name="stepSize" title="Select step size for operations below" value="{{step}}"><label>{{step}} ml</label></td>
				{% endif %}
				{% endfor %}
			</div>
			<div class="content-notitle">
			{% for dose in doseList %}
				<button type="submit" form="queueDose" title="add dose {{dose.doseName}} to run queue" name="doseName" onclick="return confirm('Are you sure?')" class="btn" value="{{dose.doseName}}" />{{dose.doseName}}</button>
			{% endfor %}
			</div>
		</form>
	</div>
</div>

{% endif %}

<!-- Dose lists -->
{% if jobList %}
<div class="py-4 bdivider">
	<div class="title">
		Dose Queue
	</div>
	<div>
		<form action="/doser/" method="post" id="updateQueue">
			<table class="table">
			{% csrf_token %}
				<thead class="table-thead">
					<th class="table-th">Dose</th>
					<th class="table-th">Status</th>
					<th class="table-th">Timestamp</th>
					<th class="table-th"></th>
				</thead>
				<tbody>
				{% for job in jobList %}
					<tr class="table-tr">
						<td class="table-td font-bold">{{job.jobName}}</td>
						<td class="table-td"><span
						{% if "Queued" in job.jobText %}
							class="btn-status btn-status-yellow"
						{% elif "Failed" in job.jobText %}
							class="btn-status btn-status-red"
						{% elif "Completed" in job.jobText %}
							class="btn-status btn-status-green"
						{% endif %}
						>{{job.jobText}}</span></td>
						<td class="table-td">{{job.timeStamp}}</td>
						<td class="table-td">
							<div class="flex justify-around items-center">
							<button class="hover:text-red-600" type="submit" form="updateQueue" name="jobAction"
						{% if job.jobAction == "DELETE" %}
							title="Delete this job from the queue" onclick="return confirm('Are You Sure?')"
						{% elif job.jobAction == "REMOVE" %}
							title="Remove this job from the queue"  onclick="return confirm('Are You Sure?')"
						{% elif job.jobAction == "CANCEL" %}
							title="Abort this job"  onclick="return confirm('Are You Sure?')"
						{% endif %}
						value="{{job.jobAction}}-{{job.jobIndex}}">
							<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
							</svg>
						<!-- {{job.jobAction}} -->
						</button></div></td>
					</tr>
				{% endfor %}
				</tbody>
			</table>
		</form>
	</div>
</div>

<!-- Liquid levels -->

<div class="py-4">
	{% csrf_token %}
	<div class="title">
		Liquid levels
	</div>

	<!-- <div class="flex justify-around items-center">

			{% for dose in doseList %}
					<div class="flex flex-col">
						<div>{{dose.doseName}}</div>
						<div>{{dose.fluidRemainingInML}}</div>
						<div>{{dose.containerInML}}</div>
					</div>
				{% endfor %}


			</div> -->



<div class="flex flex-wrap justify-center">
	{% for dose in doseList %}
	<div class="w-48">
	<div class="text-center font-bold">{{dose.doseName}}</div>
	<div class="flex justify-center items-center">
	<div class="text-center text-xs mr-2">{{dose.fluidRemainingInML}} / {{dose.containerInML}}</div>
	<div>
		<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
	  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
	</svg>
</div>
</div>

  <div class="shadow w-1/2 rounded border-2 border-gray-400 flex my-1 mx-auto relative">
    <div class="cursor-default bg-green-400 text-xs font-bold leading-none flex items-center justify-center m-1 py-4 text-center text-white"
         style="width:60%;">
      <div class="absolute left-0 mx-8 text-gray-700">10%</div>
    </div>
  	</div>
</div>
{% endfor %}
</div>

</div>


{% endif %}
{% endblock %}

<!-- <table>
<tr>
	<td title="Dose performed or queued to be run">{{job.jobName}}</td>
	<td><input type="input" name="jobStatus" title="Status of the job" readonly="readonly" value="{{job.jobText}}" /></td>
	<td><input type="input" name="timeStamp" title="When the job was completed or queued" value="{{job.timeStamp}}" /></td>
	<td><button type="submit" form="updateQueue" name="jobAction"
	{% if job.jobAction == "DELETE" %}
		title="Delete this job from the queue" onclick="return confirm('Are You Sure?')"
	{% elif job.jobAction == "REMOVE" %}
		title="Remove this job from the queue"  onclick="return confirm('Are You Sure?')"
	{% elif job.jobAction == "CANCEL" %}
		title="Abort this job"  onclick="return confirm('Are You Sure?')"
	{% endif %}
	value="{{job.jobAction}}-{{job.jobIndex}}">{{job.jobAction}}</button></td>
</tr>
</table> -->
